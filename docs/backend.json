
{
  "entities": {
    "Block": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Bloco",
      "type": "object",
      "description": "Representa um bloco ou edifício físico dentro do sistema de inventário.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único para a entidade Bloco."
        },
        "name": {
          "type": "string",
          "description": "O nome do bloco."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Sector": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Setor",
      "type": "object",
      "description": "Representa um setor ou departamento dentro de um bloco.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único para a entidade Setor."
        },
        "name": {
          "type": "string",
          "description": "O nome do setor."
        },
        "blockId": {
          "type": "string",
          "description": "Referência ao Bloco. (Relação: Bloco 1:N Setor)"
        }
      },
      "required": [
        "id",
        "name",
        "blockId"
      ]
    },
    "Room": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Sala",
      "type": "object",
      "description": "Representa uma sala dentro de um setor.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único para a entidade Sala."
        },
        "name": {
          "type": "string",
          "description": "O nome da sala."
        },
        "sectorId": {
          "type": "string",
          "description": "Referência ao Setor. (Relação: Setor 1:N Sala)"
        }
      },
      "required": [
        "id",
        "name",
        "sectorId"
      ]
    },
    "Asset": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Patrimonio",
      "type": "object",
      "description": "Representa um bem ou item dentro de uma sala.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único para a entidade Patrimônio. Deve ser um ID alfanumérico refletindo a localização do ativo."
        },
        "name": {
          "type": "string",
          "description": "O nome do patrimônio."
        },
        "roomId": {
          "type": "string",
          "description": "Referência à Sala. (Relação: Sala 1:N Patrimonio)"
        }
      },
      "required": [
        "id",
        "name",
        "roomId"
      ]
    },
    "LogGeral": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "LogGeral",
      "type": "object",
      "description": "Representa um registro de log simples para o dashboard geral.",
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "O carimbo de data/hora de quando a ação ocorreu."
        },
        "acao": {
          "type": "string",
          "description": "Descrição da ação que ocorreu."
        }
      },
      "required": ["timestamp", "acao"]
    },
    "LogEspecifico": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "LogEspecifico",
      "type": "object",
      "description": "Representa um registro de log detalhado para o histórico de um patrimônio específico.",
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "O carimbo de data/hora de quando a movimentação ocorreu."
        },
        "action": {
          "type": "string",
          "description": "O tipo de ação que ocorreu.",
          "enum": ["Criado", "Status Alterado", "Movido", "Nome Alterado"]
        },
        "from": {
          "type": "string",
          "description": "O estado ou localização antes da alteração."
        },
        "to": {
          "type": "string",
          "description": "O estado ou localização após da alteração."
        },
        "assetNameSnapshot": {
          "type": "string",
          "description": "O nome do patrimônio no momento da movimentação."
        }
      },
      "required": ["timestamp", "action", "from", "to", "assetNameSnapshot"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/blocos/{blocoId}",
        "definition": {
          "schema": { "$ref": "#/backend/entities/Block" },
          "description": "Coleção de blocos."
        }
      },
      {
        "path": "/setores/{setorId}",
        "definition": {
          "schema": { "$ref": "#/backend/entities/Sector" },
          "description": "Coleção de setores."
        }
      },
      {
        "path": "/salas/{salaId}",
        "definition": {
          "schema": { "$ref": "#/backend/entities/Room" },
          "description": "Coleção de salas."
        }
      },
      {
        "path": "/patrimonios/{patrimonioId}",
        "definition": {
          "schema": { "$ref": "#/backend/entities/Asset" },
          "description": "Coleção de patrimônios.",
          "subcollections": [
            {
              "path": "log_especifico/{logId}",
              "definition": {
                "schema": { "$ref": "#/backend/entities/LogEspecifico" },
                "description": "Sub-coleção para o histórico detalhado de um patrimônio."
              }
            }
          ]
        }
      },
      {
        "path": "/log_geral/{logId}",
        "definition": {
          "schema": { "$ref": "#/backend/entities/LogGeral" },
          "description": "Coleção principal para o log de atividades geral do dashboard."
        }
      }
    ],
    "reasoning": "A arquitetura de log foi dividida em duas coleções: uma coleção principal 'log_geral' para o dashboard e uma sub-coleção 'log_especifico' dentro de cada patrimônio para o histórico detalhado, eliminando conflitos de regras de segurança."
  }
}
